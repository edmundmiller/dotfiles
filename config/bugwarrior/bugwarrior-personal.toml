# Bugwarrior configuration for personal machine (MacTraitor-Pro)
# Credentials via opnix (1Password integration)

[general]
targets = [
    "my_reminders",
    "linear_family",
    "github_personal_issues",
    "github_personal_prs",
    "github_phd_issues",
    "github_phd_prs",
    "github_nfcore_issues",
    "github_nfcore_prs",
]
taskrc = "~/.taskrc"
log_level = "INFO"
annotation_links = true
merge_annotations = true
merge_tags = true
reopen_completed_tasks = false
# Preserve local priority changes; status now managed by native status_map per-service
static_fields = ["priority"]

# =============================================================================
# Apple Reminders
# =============================================================================

[my_reminders]
service = "applereminders"
description_template = "{{applereminderstitle}}"
lists = ["Reminders"]
area_template = "personal"

# =============================================================================
# Linear - Family Planning Board
# =============================================================================

[linear_family]
service = "linear"
api_token = "@oracle:eval:cat /usr/local/var/opnix/secrets/bugwarrior-linear-token"
description_template = "{{linearidentifier}} - {{lineartitle}}"
only_if_assigned = "edmund.a.miller@gmail.com"
# Use exact status names (case-sensitive) instead of status_types
# Excluded: Done, Canceled, Duplicate (completed/inactive)
statuses = ["Triage", "Backlog", "Todo", "In Progress", "In Review"]
import_labels_as_tags = true
add_tags = ["linear", "family"]
# NOTE: Linear priority mapping not working - bugwarrior's Linear service doesn't export
# priority field. Would need a bugwarrior PR to add linearpriority UDA.
# Linear priority values: 1=Urgent, 2=High, 3=Normal, 4=Low, 0=None
# For now, using default_priority as fallback
default_priority = "M"
area_template = "family"
# Map Linear status to TaskWarrior status
status_map = [
    { upstream = "Triage", taskwarrior = "waiting" },
    { upstream = "Backlog", taskwarrior = "waiting" },
    { upstream = "Todo", taskwarrior = "pending" },
    { upstream = "In Progress", taskwarrior = "pending" },
    { upstream = "In Review", taskwarrior = "pending" },
]

# =============================================================================
# GitHub - Personal (edmundmiller, BioJulia)
# =============================================================================

[github_personal_issues]
service = "github"
login = "edmundmiller"
token = "@oracle:eval:cat /usr/local/var/opnix/secrets/bugwarrior-github-token"
username = "edmundmiller"
description_template = "{{githubtitle}}"
project_template = "{{githubrepo|replace('/', '.')}}"
query = "is:issue assignee:edmundmiller is:open updated:>=2025-09-09 user:edmundmiller org:BioJulia -repo:edmundmiller/mill-docs"
include_user_issues = false
include_user_repos = false
add_tags = ["github", "bw", "assigned"]
# TODO: Review GitHub default priorities - should these be higher?
default_priority = "L"
area_template = "personal"

[github_personal_prs]
service = "github"
login = "edmundmiller"
token = "@oracle:eval:cat /usr/local/var/opnix/secrets/bugwarrior-github-token"
username = "edmundmiller"
description_template = "Review {{githubtitle}}"
project_template = "{{githubrepo|replace('/', '.')}}"
query = "is:pr assignee:edmundmiller is:open updated:>=2025-09-09 user:edmundmiller org:BioJulia -author:app/renovate -author:app/dependabot"
include_user_issues = false
include_user_repos = false
add_tags = ["PR", "github", "bw"]
default_priority = "L"
area_template = "personal"

# =============================================================================
# GitHub - PhD (Functional-Genomics-Lab)
# =============================================================================

[github_phd_issues]
service = "github"
login = "edmundmiller"
token = "@oracle:eval:cat /usr/local/var/opnix/secrets/bugwarrior-github-token"
username = "edmundmiller"
description_template = "{{githubtitle}}"
project_template = "{{githubrepo|replace('/', '.')}}"
query = "is:issue assignee:edmundmiller is:open updated:>=2025-09-09 org:Functional-Genomics-Lab"
include_user_issues = false
include_user_repos = false
add_tags = ["github", "bw", "assigned"]
default_priority = "L"
area_template = "phd"

[github_phd_prs]
service = "github"
login = "edmundmiller"
token = "@oracle:eval:cat /usr/local/var/opnix/secrets/bugwarrior-github-token"
username = "edmundmiller"
description_template = "Review {{githubtitle}}"
project_template = "{{githubrepo|replace('/', '.')}}"
query = "is:pr assignee:edmundmiller is:open updated:>=2025-09-09 org:Functional-Genomics-Lab -author:app/renovate -author:app/dependabot"
include_user_issues = false
include_user_repos = false
add_tags = ["PR", "github", "bw"]
default_priority = "L"
area_template = "phd"

# =============================================================================
# GitHub - nf-core (nf-core, bioinformaticsorphanage, bioconda)
# =============================================================================

[github_nfcore_issues]
service = "github"
login = "edmundmiller"
token = "@oracle:eval:cat /usr/local/var/opnix/secrets/bugwarrior-github-token"
username = "edmundmiller"
description_template = "{{githubtitle}}"
project_template = "{{githubrepo|replace('/', '.')}}"
query = "is:issue assignee:edmundmiller is:open updated:>=2025-09-09 org:nf-core org:bioinformaticsorphanage org:bioconda"
include_user_issues = false
include_user_repos = false
add_tags = ["github", "bw", "assigned"]
default_priority = "L"
area_template = "nfcore"

[github_nfcore_prs]
service = "github"
login = "edmundmiller"
token = "@oracle:eval:cat /usr/local/var/opnix/secrets/bugwarrior-github-token"
username = "edmundmiller"
description_template = "Review {{githubtitle}}"
project_template = "{{githubrepo|replace('/', '.')}}"
query = "is:pr assignee:edmundmiller is:open updated:>=2025-09-09 org:nf-core org:bioinformaticsorphanage org:bioconda -author:app/renovate -author:app/dependabot"
include_user_issues = false
include_user_repos = false
add_tags = ["PR", "github", "bw"]
default_priority = "L"
area_template = "nfcore"
